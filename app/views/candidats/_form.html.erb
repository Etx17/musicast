
<%= simple_form_for(@candidat) do |f| %>
  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

  <div class="form-inputs bg-white p-3 rounded-4 shadow-sm">
    <div class="d-flex flex-column flex-sm-row gap-3 ">
      <%= f.input :first_name, label: 'Prénom' , input_html: {class:"border border-0  mb-0"} %>
      <%= f.input :last_name, label: 'Nom', input_html: {class:"border border-0  mb-0 "}  %>
      <%= f.input :birthdate, label: 'Date de naissance', input_html: {class:"border border-0  mb-0"} , hint: "Votre identité sera validée le jour du concours, attention a rentrer votre date de naissance exacte!" %>
    </div>
    <div class="d-flex align-items-center gap-2">
      <p class="mb-0">Nationalité: </p>
      <%= f.country_select :nationality, {}, { class: "my-3 p-2 bg-light border rounded" }  %>
    </div>
    <%= f.input :bio, label: false, placeholder: "Bio: la courte phrase d'accorche qui apparaîtra sous votre photo", input_html: {class:"border border-0 "}  %>
    <%= f.input :short_bio, placeholder: "Une version très courte de votre parcours, à destination des jurys de concours" , input_html: {class:"border border-0 "} %>
    <%= f.input :medium_bio, placeholder: "Une version résumée de votre parcours, à destination des jurys de concours", input_html: {class:"border border-0 "}  %>
    <%= f.input :long_bio,  placeholder: "Une version détaillée de votre parcours, à destination des jurys de concours", input_html: {class:"border border-0 "}  %>
    <%= f.input :repertoire,  placeholder: "Décrivez votre répertoire", input_html: {class:"border border-0 "} %>
  </div>

  <div class="form-inputs bg-white p-3 rounded-4 shadow-sm mt-3">
    <div data-controller="experiences">
      <h3>Expériences</h3>
      <div data-experiences-target="container">
        <%= f.simple_fields_for :experiences do |fexp| %>
          <%= render "experience_fields", f:fexp %>
        <% end %>
      </div>

      <div data-experiences-target="template" style="display: none">
        <%= f.simple_fields_for :experiences, Experience.new, child_index: 'NEW_RECORD' do |fexp| %>
          <%= render "experience_fields", f:fexp %>
        <% end %>
      </div>

      <div class="d-flex gap-3 justify-content-center">
        <%= link_to '#', data: { action: 'experiences#addExperience' }, class: ' rounded-pill btn btn-outline-secondary m-0' do %>
          <i class="fas fa-plus fa-2x m-0 "></i>
        <% end %>
      </div>
    </div>
  </div>

   <div class="form-inputs bg-white p-3 rounded-4 shadow-sm mt-3">
    <div data-controller="experiences">
      <h3>Formation</h3>
      <div data-experiences-target="container">
        <%= f.simple_fields_for :educations do |fexp| %>
          <%= render "education_fields", f:fexp %>
        <% end %>
      </div>

      <div data-experiences-target="template" style="display: none">
        <%= f.simple_fields_for :educations, Education.new, child_index: 'NEW_RECORD' do |fexp| %>
          <%= render "education_fields", f:fexp %>
        <% end %>
      </div>

      <div class="d-flex gap-3 justify-content-center">
        <%= link_to '#', data: { action: 'experiences#addExperience' }, class: ' rounded-pill btn btn-outline-secondary m-0' do %>
          <i class="fas fa-plus fa-2x m-0 "></i>
        <% end %>
      </div>
    </div>
  </div>




  <div class="p-3 bg-white rounded-4 d-flex flex-column border mt-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2>Diplômes et Certifications</h2>
    </div>

    <% if @candidat.diplomas.attached? %>
      <div class="d-flex flex-wrap gap-3 mb-3">
        <% @candidat.diplomas.each do |diploma| %>
          <div class="d-flex flex-column">
            <embed src="<%= url_for(diploma) %>" width="200" height="200" type="application/pdf">
            <div class="d-flex gap-3 justify-content-between ">

              <%= link_to 'Voir', url_for(diploma), target: "_blank", class: "btn btn-outline-dark border-0 shadow-sm" %>
              <%= button_to 'Delete', delete_diploma_candidat_path(diploma_id: diploma.id), method: :delete, data: { turbo_confirm: 'Are you sure?' }, class: "btn btn-outline-dark border-0 shadow-sm" %>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <p class="text-muted">Vous n'avez pas encore ajouté de diplôme.</p>
    <% end %>

    <%= form_with(model: @candidat, url: add_diploma_candidat_path(@candidat), local: true,  method: :post) do |form| %>
      <%= form.label :new_diploma, "Ajouter un diplôme" %>
      <%= form.file_field :new_diploma, multiple: true %>
      <%= form.submit "Ajouter" %>
    <% end %>
  </div>


  <div class="form-actions">
    <%= f.button :submit, "Enregistrer", class:"btn btn-primary" %>
  </div>
<% end %>
